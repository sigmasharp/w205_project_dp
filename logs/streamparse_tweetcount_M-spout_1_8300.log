2015-11-05 17:47:06,243 - kafka.client - DEBUG - Request 1: []
2015-11-05 17:47:06,243 - kafka.conn - DEBUG - Reinitializing socket connection for localhost:9092
2015-11-05 17:47:06,267 - kafka.conn - DEBUG - About to send 30 bytes to Kafka, request 1
2015-11-05 17:47:06,268 - kafka.conn - DEBUG - Reading response 1 from Kafka
2015-11-05 17:47:06,268 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-05 17:47:06,268 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-05 17:47:06,268 - kafka.conn - DEBUG - About to read 216 bytes from Kafka
2015-11-05 17:47:06,269 - kafka.conn - DEBUG - Read 216/216 bytes from Kafka
2015-11-05 17:47:06,277 - kafka.client - DEBUG - Response 1: MetadataResponse(brokers=[BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092)], topics=[TopicMetadata(topic='my-topic', error=0, partitions=[PartitionMetadata(topic='my-topic', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='product-1', error=0, partitions=[PartitionMetadata(topic='product-1', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='raw_data', error=0, partitions=[PartitionMetadata(topic='raw_data', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='test', error=0, partitions=[PartitionMetadata(topic='test', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)])])
2015-11-05 17:47:06,277 - kafka.client - INFO - Updating broker metadata: [BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092)]
2015-11-05 17:47:06,278 - kafka.client - INFO - Updating topic metadata: [TopicMetadata(topic='my-topic', error=0, partitions=[PartitionMetadata(topic='my-topic', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='product-1', error=0, partitions=[PartitionMetadata(topic='product-1', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='raw_data', error=0, partitions=[PartitionMetadata(topic='raw_data', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='test', error=0, partitions=[PartitionMetadata(topic='test', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)])]
2015-11-05 17:47:06,278 - kafka.client - DEBUG - Request 2: ['product-1']
2015-11-05 17:47:06,278 - kafka.conn - DEBUG - About to send 41 bytes to Kafka, request 2
2015-11-05 17:47:06,280 - kafka.conn - DEBUG - Reading response 2 from Kafka
2015-11-05 17:47:06,280 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-05 17:47:06,280 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-05 17:47:06,280 - kafka.conn - DEBUG - About to read 94 bytes from Kafka
2015-11-05 17:47:06,280 - kafka.conn - DEBUG - Read 94/94 bytes from Kafka
2015-11-05 17:47:06,281 - kafka.client - DEBUG - Response 2: MetadataResponse(brokers=[BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092)], topics=[TopicMetadata(topic='product-1', error=0, partitions=[PartitionMetadata(topic='product-1', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)])])
2015-11-05 17:47:06,281 - kafka.client - INFO - Updating broker metadata: [BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092)]
2015-11-05 17:47:06,281 - kafka.client - INFO - Updating topic metadata: [TopicMetadata(topic='product-1', error=0, partitions=[PartitionMetadata(topic='product-1', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)])]
2015-11-05 17:47:06,281 - kafka.client - DEBUG - Request 3 to BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092): [OffsetFetchRequest(topic='product-1', partition=0)]
2015-11-05 17:47:06,281 - kafka.conn - DEBUG - Reinitializing socket connection for ip-172-31-50-233.ec2.internal:9092
2015-11-05 17:47:06,284 - kafka.conn - DEBUG - About to send 61 bytes to Kafka, request 3
2015-11-05 17:47:06,284 - kafka.conn - DEBUG - Reading response 3 from Kafka
2015-11-05 17:47:06,284 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-05 17:47:06,285 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-05 17:47:06,285 - kafka.conn - DEBUG - About to read 39 bytes from Kafka
2015-11-05 17:47:06,286 - kafka.conn - DEBUG - Read 39/39 bytes from Kafka
2015-11-05 17:47:06,286 - kafka.client - DEBUG - Response 3: [OffsetFetchResponse(topic='product-1', partition=0, offset=317, metadata='', error=0)]
2015-11-05 17:47:06,286 - kafka.consumer.simple - DEBUG - internal queue empty, fetching more messages
2015-11-05 17:47:06,286 - kafka.client - DEBUG - Request 4 to BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092): [FetchRequest(topic='product-1', partition=0, offset=317, max_bytes=4096)]
2015-11-05 17:47:06,286 - kafka.conn - DEBUG - About to send 73 bytes to Kafka, request 4
2015-11-05 17:47:06,287 - kafka.conn - DEBUG - Reading response 4 from Kafka
2015-11-05 17:47:06,287 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-05 17:47:06,288 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-05 17:47:06,288 - kafka.conn - DEBUG - About to read 4137 bytes from Kafka
2015-11-05 17:47:06,288 - kafka.conn - DEBUG - Read 4096/4137 bytes from Kafka
2015-11-05 17:47:06,288 - kafka.conn - DEBUG - Read 4137/4137 bytes from Kafka
2015-11-05 17:47:06,288 - kafka.client - DEBUG - Response 4: [FetchResponse(topic='product-1', partition=0, error=0, highwaterMark=40516, messages=<generator object _decode_message_set_iter at 0x27e39b0>)]
2015-11-05 17:47:06,299 - streamparse.storm.component - ERROR - Exception in Messages.run()
Traceback (most recent call last):
  File "/usr/lib/python2.7/site-packages/streamparse/storm/component.py", line 489, in run
    self._run()
  File "/usr/lib/python2.7/site-packages/streamparse/storm/spout.py", line 150, in _run
    self.next_tuple()
  File "spouts/messages.py", line 15, in next_tuple
    message = next(self.messages).value
AttributeError: 'OffsetAndMessage' object has no attribute 'value'
2015-11-05 17:47:06,342 - kafka.consumer - INFO - Committing new offsets for product-1, partitions [0]
2015-11-05 17:47:06,342 - kafka.consumer - DEBUG - Commit offset 318 in SimpleConsumer: group=new_1group, topic=product-1, partition=0
2015-11-05 17:47:06,342 - kafka.client - DEBUG - Request 5 to BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092): [OffsetCommitRequest(topic='product-1', partition=0, offset=318, metadata=None)]
2015-11-05 17:47:06,342 - kafka.conn - DEBUG - About to send 71 bytes to Kafka, request 5
2015-11-05 17:47:06,342 - kafka.conn - DEBUG - Reading response 5 from Kafka
2015-11-05 17:47:06,343 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-05 17:47:06,345 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-05 17:47:06,345 - kafka.conn - DEBUG - About to read 29 bytes from Kafka
2015-11-05 17:47:06,345 - kafka.conn - DEBUG - Read 29/29 bytes from Kafka
2015-11-05 17:47:06,345 - kafka.client - DEBUG - Response 5: [OffsetCommitResponse(topic='product-1', partition=0, error=0)]
