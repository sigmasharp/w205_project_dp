2015-11-13 21:19:17,211 - kafka.client - DEBUG - Request 1: []
2015-11-13 21:19:17,211 - kafka.conn - DEBUG - Reinitializing socket connection for localhost:9092
2015-11-13 21:19:17,231 - kafka.conn - DEBUG - About to send 30 bytes to Kafka, request 1
2015-11-13 21:19:17,231 - kafka.conn - DEBUG - Reading response 1 from Kafka
2015-11-13 21:19:17,232 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-13 21:19:17,232 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-13 21:19:17,232 - kafka.conn - DEBUG - About to read 384 bytes from Kafka
2015-11-13 21:19:17,232 - kafka.conn - DEBUG - Read 384/384 bytes from Kafka
2015-11-13 21:19:17,232 - kafka.client - DEBUG - Response 1: MetadataResponse(brokers=[BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092)], topics=[TopicMetadata(topic='Product4', error=0, partitions=[PartitionMetadata(topic='Product4', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='my-topic', error=0, partitions=[PartitionMetadata(topic='my-topic', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='Product3', error=0, partitions=[PartitionMetadata(topic='Product3', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='product-1', error=0, partitions=[PartitionMetadata(topic='product-1', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='raw_data', error=0, partitions=[PartitionMetadata(topic='raw_data', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='Product2', error=0, partitions=[PartitionMetadata(topic='Product2', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='Product1', error=0, partitions=[PartitionMetadata(topic='Product1', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='test', error=0, partitions=[PartitionMetadata(topic='test', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)])])
2015-11-13 21:19:17,235 - kafka.client - INFO - Updating broker metadata: [BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092)]
2015-11-13 21:19:17,235 - kafka.client - INFO - Updating topic metadata: [TopicMetadata(topic='Product4', error=0, partitions=[PartitionMetadata(topic='Product4', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='my-topic', error=0, partitions=[PartitionMetadata(topic='my-topic', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='Product3', error=0, partitions=[PartitionMetadata(topic='Product3', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='product-1', error=0, partitions=[PartitionMetadata(topic='product-1', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='raw_data', error=0, partitions=[PartitionMetadata(topic='raw_data', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='Product2', error=0, partitions=[PartitionMetadata(topic='Product2', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='Product1', error=0, partitions=[PartitionMetadata(topic='Product1', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)]), TopicMetadata(topic='test', error=0, partitions=[PartitionMetadata(topic='test', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)])]
2015-11-13 21:19:17,235 - kafka.client - DEBUG - Request 2: ['Product1']
2015-11-13 21:19:17,235 - kafka.conn - DEBUG - About to send 40 bytes to Kafka, request 2
2015-11-13 21:19:17,236 - kafka.conn - DEBUG - Reading response 2 from Kafka
2015-11-13 21:19:17,236 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-13 21:19:17,236 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-13 21:19:17,236 - kafka.conn - DEBUG - About to read 93 bytes from Kafka
2015-11-13 21:19:17,236 - kafka.conn - DEBUG - Read 93/93 bytes from Kafka
2015-11-13 21:19:17,237 - kafka.client - DEBUG - Response 2: MetadataResponse(brokers=[BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092)], topics=[TopicMetadata(topic='Product1', error=0, partitions=[PartitionMetadata(topic='Product1', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)])])
2015-11-13 21:19:17,237 - kafka.client - INFO - Updating broker metadata: [BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092)]
2015-11-13 21:19:17,237 - kafka.client - INFO - Updating topic metadata: [TopicMetadata(topic='Product1', error=0, partitions=[PartitionMetadata(topic='Product1', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)])]
2015-11-13 21:19:17,238 - kafka.client - DEBUG - Request 3 to BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092): [OffsetFetchRequest(topic='Product1', partition=0)]
2015-11-13 21:19:17,238 - kafka.conn - DEBUG - Reinitializing socket connection for ip-172-31-50-233.ec2.internal:9092
2015-11-13 21:19:17,279 - kafka.conn - DEBUG - About to send 51 bytes to Kafka, request 3
2015-11-13 21:19:17,280 - kafka.conn - DEBUG - Reading response 3 from Kafka
2015-11-13 21:19:17,280 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-13 21:19:17,281 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-13 21:19:17,281 - kafka.conn - DEBUG - About to read 38 bytes from Kafka
2015-11-13 21:19:17,281 - kafka.conn - DEBUG - Read 38/38 bytes from Kafka
2015-11-13 21:19:17,281 - kafka.client - DEBUG - Response 3: [OffsetFetchResponse(topic='Product1', partition=0, offset=90, metadata='', error=0)]
2015-11-13 21:19:17,282 - kafka.client - DEBUG - Request 4: ['Product2']
2015-11-13 21:19:17,282 - kafka.conn - DEBUG - About to send 40 bytes to Kafka, request 4
2015-11-13 21:19:17,282 - kafka.conn - DEBUG - Reading response 4 from Kafka
2015-11-13 21:19:17,282 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-13 21:19:17,283 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-13 21:19:17,283 - kafka.conn - DEBUG - About to read 93 bytes from Kafka
2015-11-13 21:19:17,283 - kafka.conn - DEBUG - Read 93/93 bytes from Kafka
2015-11-13 21:19:17,283 - kafka.client - DEBUG - Response 4: MetadataResponse(brokers=[BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092)], topics=[TopicMetadata(topic='Product2', error=0, partitions=[PartitionMetadata(topic='Product2', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)])])
2015-11-13 21:19:17,283 - kafka.client - INFO - Updating broker metadata: [BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092)]
2015-11-13 21:19:17,283 - kafka.client - INFO - Updating topic metadata: [TopicMetadata(topic='Product2', error=0, partitions=[PartitionMetadata(topic='Product2', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)])]
2015-11-13 21:19:17,296 - kafka.client - DEBUG - Request 5 to BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092): [OffsetFetchRequest(topic='Product2', partition=0)]
2015-11-13 21:19:17,297 - kafka.conn - DEBUG - About to send 51 bytes to Kafka, request 5
2015-11-13 21:19:17,298 - kafka.conn - DEBUG - Reading response 5 from Kafka
2015-11-13 21:19:17,298 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-13 21:19:17,298 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-13 21:19:17,298 - kafka.conn - DEBUG - About to read 38 bytes from Kafka
2015-11-13 21:19:17,298 - kafka.conn - DEBUG - Read 38/38 bytes from Kafka
2015-11-13 21:19:17,298 - kafka.client - DEBUG - Response 5: [OffsetFetchResponse(topic='Product2', partition=0, offset=90, metadata='', error=0)]
2015-11-13 21:19:17,299 - kafka.client - DEBUG - Request 6: ['Product3']
2015-11-13 21:19:17,299 - kafka.conn - DEBUG - About to send 40 bytes to Kafka, request 6
2015-11-13 21:19:17,307 - kafka.conn - DEBUG - Reading response 6 from Kafka
2015-11-13 21:19:17,308 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-13 21:19:17,308 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-13 21:19:17,309 - kafka.conn - DEBUG - About to read 93 bytes from Kafka
2015-11-13 21:19:17,309 - kafka.conn - DEBUG - Read 93/93 bytes from Kafka
2015-11-13 21:19:17,309 - kafka.client - DEBUG - Response 6: MetadataResponse(brokers=[BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092)], topics=[TopicMetadata(topic='Product3', error=0, partitions=[PartitionMetadata(topic='Product3', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)])])
2015-11-13 21:19:17,309 - kafka.client - INFO - Updating broker metadata: [BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092)]
2015-11-13 21:19:17,309 - kafka.client - INFO - Updating topic metadata: [TopicMetadata(topic='Product3', error=0, partitions=[PartitionMetadata(topic='Product3', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)])]
2015-11-13 21:19:17,310 - kafka.client - DEBUG - Request 7 to BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092): [OffsetFetchRequest(topic='Product3', partition=0)]
2015-11-13 21:19:17,310 - kafka.conn - DEBUG - About to send 51 bytes to Kafka, request 7
2015-11-13 21:19:17,310 - kafka.conn - DEBUG - Reading response 7 from Kafka
2015-11-13 21:19:17,310 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-13 21:19:17,311 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-13 21:19:17,311 - kafka.conn - DEBUG - About to read 38 bytes from Kafka
2015-11-13 21:19:17,311 - kafka.conn - DEBUG - Read 38/38 bytes from Kafka
2015-11-13 21:19:17,311 - kafka.client - DEBUG - Response 7: [OffsetFetchResponse(topic='Product3', partition=0, offset=90, metadata='', error=0)]
2015-11-13 21:19:17,311 - kafka.client - DEBUG - Request 8: ['Product4']
2015-11-13 21:19:17,312 - kafka.conn - DEBUG - About to send 40 bytes to Kafka, request 8
2015-11-13 21:19:17,312 - kafka.conn - DEBUG - Reading response 8 from Kafka
2015-11-13 21:19:17,312 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-13 21:19:17,312 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-13 21:19:17,312 - kafka.conn - DEBUG - About to read 93 bytes from Kafka
2015-11-13 21:19:17,313 - kafka.conn - DEBUG - Read 93/93 bytes from Kafka
2015-11-13 21:19:17,313 - kafka.client - DEBUG - Response 8: MetadataResponse(brokers=[BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092)], topics=[TopicMetadata(topic='Product4', error=0, partitions=[PartitionMetadata(topic='Product4', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)])])
2015-11-13 21:19:17,313 - kafka.client - INFO - Updating broker metadata: [BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092)]
2015-11-13 21:19:17,313 - kafka.client - INFO - Updating topic metadata: [TopicMetadata(topic='Product4', error=0, partitions=[PartitionMetadata(topic='Product4', partition=0, leader=0, replicas=(0,), isr=(0,), error=0)])]
2015-11-13 21:19:17,313 - kafka.client - DEBUG - Request 9 to BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092): [OffsetFetchRequest(topic='Product4', partition=0)]
2015-11-13 21:19:17,314 - kafka.conn - DEBUG - About to send 51 bytes to Kafka, request 9
2015-11-13 21:19:17,314 - kafka.conn - DEBUG - Reading response 9 from Kafka
2015-11-13 21:19:17,314 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-13 21:19:17,315 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-13 21:19:17,315 - kafka.conn - DEBUG - About to read 38 bytes from Kafka
2015-11-13 21:19:17,315 - kafka.conn - DEBUG - Read 38/38 bytes from Kafka
2015-11-13 21:19:17,315 - kafka.client - DEBUG - Response 9: [OffsetFetchResponse(topic='Product4', partition=0, offset=88, metadata='', error=0)]
2015-11-13 21:19:17,331 - kafka.consumer.simple - DEBUG - internal queue empty, fetching more messages
2015-11-13 21:19:17,344 - kafka.client - DEBUG - Request 10 to BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092): [FetchRequest(topic='Product1', partition=0, offset=90, max_bytes=4096)]
2015-11-13 21:19:17,344 - kafka.conn - DEBUG - About to send 72 bytes to Kafka, request 10
2015-11-13 21:19:17,345 - kafka.conn - DEBUG - Reading response 10 from Kafka
2015-11-13 21:19:17,345 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-13 21:19:17,345 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-13 21:19:17,345 - kafka.conn - DEBUG - About to read 4136 bytes from Kafka
2015-11-13 21:19:17,345 - kafka.conn - DEBUG - Read 4096/4136 bytes from Kafka
2015-11-13 21:19:17,345 - kafka.conn - DEBUG - Read 4136/4136 bytes from Kafka
2015-11-13 21:19:17,345 - kafka.client - DEBUG - Response 10: [FetchResponse(topic='Product1', partition=0, error=0, highwaterMark=1998, messages=<generator object _decode_message_set_iter at 0x238be10>)]
2015-11-13 21:19:17,346 - kafka.consumer.simple - DEBUG - internal queue empty, fetching more messages
2015-11-13 21:19:17,346 - kafka.client - DEBUG - Request 11 to BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092): [FetchRequest(topic='Product2', partition=0, offset=90, max_bytes=4096)]
2015-11-13 21:19:17,346 - kafka.conn - DEBUG - About to send 72 bytes to Kafka, request 11
2015-11-13 21:19:17,347 - kafka.conn - DEBUG - Reading response 11 from Kafka
2015-11-13 21:19:17,347 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-13 21:19:17,347 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-13 21:19:17,347 - kafka.conn - DEBUG - About to read 4136 bytes from Kafka
2015-11-13 21:19:17,348 - kafka.conn - DEBUG - Read 4096/4136 bytes from Kafka
2015-11-13 21:19:17,377 - kafka.conn - DEBUG - Read 4136/4136 bytes from Kafka
2015-11-13 21:19:17,377 - kafka.client - DEBUG - Response 11: [FetchResponse(topic='Product2', partition=0, error=0, highwaterMark=1998, messages=<generator object _decode_message_set_iter at 0x238bdc0>)]
2015-11-13 21:19:17,378 - kafka.consumer.simple - DEBUG - internal queue empty, fetching more messages
2015-11-13 21:19:17,378 - kafka.client - DEBUG - Request 12 to BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092): [FetchRequest(topic='Product3', partition=0, offset=90, max_bytes=4096)]
2015-11-13 21:19:17,378 - kafka.conn - DEBUG - About to send 72 bytes to Kafka, request 12
2015-11-13 21:19:17,379 - kafka.conn - DEBUG - Reading response 12 from Kafka
2015-11-13 21:19:17,379 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-13 21:19:17,379 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-13 21:19:17,379 - kafka.conn - DEBUG - About to read 4136 bytes from Kafka
2015-11-13 21:19:17,379 - kafka.conn - DEBUG - Read 4096/4136 bytes from Kafka
2015-11-13 21:19:17,380 - kafka.conn - DEBUG - Read 4136/4136 bytes from Kafka
2015-11-13 21:19:17,380 - kafka.client - DEBUG - Response 12: [FetchResponse(topic='Product3', partition=0, error=0, highwaterMark=1998, messages=<generator object _decode_message_set_iter at 0x238be10>)]
2015-11-13 21:19:17,393 - streamparse.storm.component - ERROR - Exception in Messages.run()
Traceback (most recent call last):
  File "/usr/lib/python2.7/site-packages/streamparse/storm/component.py", line 489, in run
    self._run()
  File "/usr/lib/python2.7/site-packages/streamparse/storm/spout.py", line 150, in _run
    self.next_tuple()
  File "spouts/messages.py", line 20, in next_tuple
    message3 = u"Product3:"+next(self.messages3).message.value
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc2 in position 61: ordinal not in range(128)
2015-11-13 21:19:17,486 - kafka.consumer - INFO - Committing new offsets for Product3, partitions [0]
2015-11-13 21:19:17,486 - kafka.consumer - DEBUG - Commit offset 91 in SimpleConsumer: group=e, topic=Product3, partition=0
2015-11-13 21:19:17,486 - kafka.client - DEBUG - Request 13 to BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092): [OffsetCommitRequest(topic='Product3', partition=0, offset=91, metadata=None)]
2015-11-13 21:19:17,486 - kafka.conn - DEBUG - About to send 61 bytes to Kafka, request 13
2015-11-13 21:19:17,486 - kafka.conn - DEBUG - Reading response 13 from Kafka
2015-11-13 21:19:17,487 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-13 21:19:17,488 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-13 21:19:17,489 - kafka.conn - DEBUG - About to read 28 bytes from Kafka
2015-11-13 21:19:17,489 - kafka.conn - DEBUG - Read 28/28 bytes from Kafka
2015-11-13 21:19:17,489 - kafka.client - DEBUG - Response 13: [OffsetCommitResponse(topic='Product3', partition=0, error=0)]
2015-11-13 21:19:17,521 - kafka.consumer - INFO - Committing new offsets for Product2, partitions [0]
2015-11-13 21:19:17,521 - kafka.consumer - DEBUG - Commit offset 91 in SimpleConsumer: group=e, topic=Product2, partition=0
2015-11-13 21:19:17,521 - kafka.client - DEBUG - Request 14 to BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092): [OffsetCommitRequest(topic='Product2', partition=0, offset=91, metadata=None)]
2015-11-13 21:19:17,521 - kafka.conn - DEBUG - About to send 61 bytes to Kafka, request 14
2015-11-13 21:19:17,522 - kafka.conn - DEBUG - Reading response 14 from Kafka
2015-11-13 21:19:17,522 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-13 21:19:17,523 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-13 21:19:17,523 - kafka.conn - DEBUG - About to read 28 bytes from Kafka
2015-11-13 21:19:17,523 - kafka.conn - DEBUG - Read 28/28 bytes from Kafka
2015-11-13 21:19:17,523 - kafka.client - DEBUG - Response 14: [OffsetCommitResponse(topic='Product2', partition=0, error=0)]
2015-11-13 21:19:17,546 - kafka.consumer - INFO - Committing new offsets for Product1, partitions [0]
2015-11-13 21:19:17,546 - kafka.consumer - DEBUG - Commit offset 91 in SimpleConsumer: group=e, topic=Product1, partition=0
2015-11-13 21:19:17,546 - kafka.client - DEBUG - Request 15 to BrokerMetadata(nodeId=0, host='ip-172-31-50-233.ec2.internal', port=9092): [OffsetCommitRequest(topic='Product1', partition=0, offset=91, metadata=None)]
2015-11-13 21:19:17,546 - kafka.conn - DEBUG - About to send 61 bytes to Kafka, request 15
2015-11-13 21:19:17,547 - kafka.conn - DEBUG - Reading response 15 from Kafka
2015-11-13 21:19:17,547 - kafka.conn - DEBUG - About to read 4 bytes from Kafka
2015-11-13 21:19:17,549 - kafka.conn - DEBUG - Read 4/4 bytes from Kafka
2015-11-13 21:19:17,549 - kafka.conn - DEBUG - About to read 28 bytes from Kafka
2015-11-13 21:19:17,549 - kafka.conn - DEBUG - Read 28/28 bytes from Kafka
2015-11-13 21:19:17,549 - kafka.client - DEBUG - Response 15: [OffsetCommitResponse(topic='Product1', partition=0, error=0)]
